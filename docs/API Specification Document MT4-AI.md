# API Specification Document for MT4-AI Trading System

---

## 1. Introduction

### 1.1 Purpose
The purpose of this document is to provide a detailed specification of the APIs used in the MT4-AI Trading System. This includes the APIs that enable communication between the MT4 Expert Advisor (EA), the Machine Learning "Brain," and the Web Application. The document will outline the endpoints, request/response formats, authentication mechanisms, and error handling strategies.

### 1.2 Scope
This document covers the API specifications required for:
- **MT4 EA to "Brain" Communication:** For sending live market data and receiving trading signals.
- **Web App to "Brain" Communication:** For monitoring, configuration, and analysis.

---

## 2. API Overview

### 2.1 API Structure
The APIs will be structured as RESTful services, following standard HTTP methods (GET, POST, PUT, DELETE). All communication between the components will be in JSON format.

### 2.2 API Endpoints Summary

| Endpoint            | Method | Description                                             |
|---------------------|--------|---------------------------------------------------------|
| /api/v1/stream_data | POST   | Stream live market data from MT4 EA to the "Brain"       |
| /api/v1/get_signal  | GET    | Retrieve trading signals from the "Brain"               |
| /api/v1/configure   | POST   | Send configuration settings from Web App to the "Brain" |
| /api/v1/monitor     | GET    | Retrieve system status and analytics from the "Brain"   |

---

## 3. API Endpoints Details

### 3.1 /api/v1/stream_data

- **Description:** This endpoint receives live market data from the MT4 EA.
- **Method:** POST
- **Request Format:**
    ```json
    {
        "timestamp": "2024-08-23T12:00:00Z",
        "symbol": "USD/JPY",
        "price": 109.45,
        "volume": 1000,
        "indicators": {
            "moving_average_10": 109.40,
            "rsi": 45.5
        }
    }
    ```
- **Response Format:**
    ```json
    {
        "status": "success",
        "message": "Data received successfully."
    }
    ```
- **Authentication:** API Key in the header (e.g., `x-api-key`).
- **Error Handling:**
    - **400 Bad Request:** If required fields are missing or invalid.
    - **401 Unauthorized:** If the API key is missing or invalid.

### 3.2 /api/v1/get_signal

- **Description:** This endpoint retrieves trading signals generated by the "Brain."
- **Method:** GET
- **Request Parameters (Query String):**
    - **symbol:** The trading symbol (e.g., `USD/JPY`).
    - **timestamp:** The time for which the signal is requested.
- **Response Format:**
    ```json
    {
        "timestamp": "2024-08-23T12:00:00Z",
        "symbol": "USD/JPY",
        "signal": "buy",
        "price": 109.45,
        "confidence": 0.85
    }
    ```
- **Authentication:** API Key in the header.
- **Error Handling:**
    - **404 Not Found:** If no signal is available for the requested symbol and timestamp.
    - **401 Unauthorized:** If the API key is missing or invalid.

### 3.3 /api/v1/configure

- **Description:** This endpoint allows the Web App to send configuration settings to the "Brain."
- **Method:** POST
- **Request Format:**
    ```json
    {
        "max_lot_size": 1.0,
        "risk_tolerance": "medium",
        "trading_strategy": "scalping",
        "indicators": {
            "moving_average_period": 10,
            "rsi_threshold": 30
        }
    }
    ```
- **Response Format:**
    ```json
    {
        "status": "success",
        "message": "Configuration updated successfully."
    }
    ```
- **Authentication:** API Key in the header.
- **Error Handling:**
    - **400 Bad Request:** If the configuration settings are invalid.
    - **401 Unauthorized:** If the API key is missing or invalid.

### 3.4 /api/v1/monitor

- **Description:** This endpoint allows the Web App to retrieve system status, performance metrics, and analytics from the "Brain."
- **Method:** GET
- **Response Format:**
    ```json
    {
        "status": "online",
        "uptime": "72 hours",
        "trades_executed": 150,
        "profit_loss": 3200.50,
        "current_configuration": {
            "max_lot_size": 1.0,
            "risk_tolerance": "medium",
            "trading_strategy": "scalping"
        }
    }
    ```
- **Authentication:** API Key in the header.
- **Error Handling:**
    - **500 Internal Server Error:** If the system is unable to retrieve the data.
    - **401 Unauthorized:** If the API key is missing or invalid.

---

## 4. Authentication and Security

### 4.1 API Key Authentication
- **Method:** All API requests must include an API key in the request header (`x-api-key`).
- **Key Management:** API keys will be managed and rotated regularly to ensure security.

### 4.2 Data Encryption
- **In Transit:** All data transmitted between components (MT4 EA, "Brain," Web App) will be encrypted using SSL/TLS.
- **At Rest:** Sensitive data will be encrypted at rest using industry-standard encryption algorithms.

### 4.3 Rate Limiting
- **Rate Limiting:** To prevent abuse, API requests will be rate-limited. Excessive requests from a single IP address or API key will result in temporary blocking.

---

## 5. Error Handling and Responses

### 5.1 Standard Error Responses
All error responses will include a standard JSON structure to ensure consistency across the system.

- **Example Error Response:**
    ```json
    {
        "status": "error",
        "error_code": "400",
        "message": "Bad Request - Missing required fields."
    }
    ```

### 5.2 HTTP Status Codes
- **200 OK:** Request was successful.
- **400 Bad Request:** The request was invalid or missing required parameters.
- **401 Unauthorized:** Authentication failed, or API key is missing/invalid.
- **404 Not Found:** The requested resource was not found.
- **500 Internal Server Error:** An error occurred on the server side.

---

## 6. Conclusion

This API Specification Document outlines the endpoints, request/response formats, and security measures for the APIs used in the MT4-AI Trading System. Following these specifications will ensure that the components of the system communicate effectively and securely.

